#!/usr/bin/env python3
# db_connect.py â€” ACS Database Connection Script
# Pod: {{ pod_id }} | Domain: acs-p{{ pod_id }}.local
# WARNING: This script contains hardcoded credentials

import pyodbc

DB_SERVER = "10.50.{{ pod_id | int }}.10"
DB_NAME = "ACS_Inventory"
DB_USER = "svc_web"
DB_PASSWORD = "password123"

def connect():
    conn_str = (
        f"DRIVER={{ODBC Driver 17 for SQL Server}};"
        f"SERVER={DB_SERVER};"
        f"DATABASE={DB_NAME};"
        f"UID={DB_USER};"
        f"PWD={DB_PASSWORD};"
    )
    return pyodbc.connect(conn_str)

def get_inventory():
    conn = connect()
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM dbo.Assets")
    rows = cursor.fetchall()
    conn.close()
    return rows

if __name__ == "__main__":
    items = get_inventory()
    for item in items:
        print(item)
